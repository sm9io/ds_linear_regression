library(Lahman)
library(Lahman)
library(dslabs)
library(tidyverse)
ds_theme_set()
Teams %>% filter(yearID %in% 1961:2001) %>%
mutate(HR_per_gane = HR/G, R_per_game = R/G) %>%
ggplot(aes(HR_pergame, R_per_game)) +
geom_point(alpha = 0.5)
Teams %>% filter(yearID %in% 1961:2001) %>%
mutate(HR_per_gane = HR/G, R_per_game = R/G) %>%
ggplot(aes(HR_per_game, R_per_game)) +
geom_point(alpha = 0.5)
Teams %>% filter(yearID %in% 1961:2001) %>%
mutate(HR_per_game = HR/G, R_per_game = R/G) %>%
ggplot(aes(HR_per_game, R_per_game)) +
geom_point(alpha = 0.5)
Teams %>% filter(yearID %in% 1961:2001) %>%
mutate(HR_per_game = HR/G, R_per_game = R/G) %>%
ggplot(aes(HR_per_game, R_per_game)) +
geom_point(alpha = 0.2)
source('~/Analytics/Projects/ds_linear_regression/Bases on Balls or Stolen Bases.R', echo=TRUE)
source('~/Analytics/Projects/ds_linear_regression/Bases on Balls or Stolen Bases.R', echo=TRUE)
# runs per game vs stolen bases per game
Teams %>% filter(yearID %in% 1961:2001) %>%
mutate(SB_per_game = SB/G, R_per_game = R/G) %>%
ggplot(aes(SB_per_game, R_per_game)) +
geom_point(alpha = 0.2)
# runs per game vs bases on balls per game
Teams %>% filter(yearID %in% 1961:2001) %>%
mutate(BB_per_game = BB/G, R_per_game = R/G) %>%
ggplot(aes(BB_per_game, R_per_game)) +
geom_point(alpha = 0.2)
ggsave("runs per game vs home runs per game.jpg")
source('~/Analytics/Projects/ds_linear_regression/Bases on Balls or Stolen Bases.R', echo=TRUE)
q()
install.packages("HistData")
source('~/Analytics/Projects/ds_linear_regression/Correlation.R', echo=TRUE)
str(GaltonFamilies)
source('~/Analytics/Projects/ds_linear_regression/Correlation.R', echo=TRUE)
galton_heights %>% gather() %>% head()
galton_heights %>% gather(key = "relation", value = "height") %>% head()
galton_heights %>% gather(key = "relation", value = "height") %>% group_by(relation) %>% summarise(mean(height), sd(height))
galton_heights %>%
gather(key = "relation", value = "height") %>%
group_by(relation) %>%
summarise(avg = mean(height), sd = sd(height))
galton_heights %>%
ggplot(aes(father, son)) +
geom_point(alpha = 0.3)
ggsave("father_son_height_1.jpg")
source('~/Analytics/Projects/ds_linear_regression/Correlation.R', echo=TRUE)
ggsave("plots/father_son_height_1.jpg")
ggsave("plots\father_son_height_1.jpg")
ggsave("plots/father_son_height_1.jpg")
ggsave("plots/father_son_height_1.jpg")
q()
source('~/Analytics/Projects/ds_linear_regression/baseball_example.R', echo=TRUE)
source('~/Analytics/Projects/ds_linear_regression/correlation.R', echo=TRUE)
galton_heights %>% summarise(correlation = cor(father, son))
r
r <- replicate(10000, {
sample_n(galton_heights, 25, replace = TRUE) %>%
summarise(r = cor(father, son)) %>%
.$r
})
data.frame(r) %>%
ggplot(aes(r)) + geom_density()
data.frame(r) %>%
ggplot(aes(r)) + geom_density(col = grey)
data.frame(r) %>%
ggplot(aes(r)) + geom_density(col = "grey")
data.frame(r) %>%
ggplot(aes(r)) + geom_density(fill = "grey")
data.frame(r) %>%
ggplot(aes(r)) + geom_density(fill = "grey", col = "grey")
data.frame(r) %>%
ggplot(aes(r)) + geom_histogram(binwidth = 0.5, col = "grey")
data.frame(r) %>%
ggplot(aes(r)) + geom_histogram(binwidth = 0.1, col = "grey")
data.frame(r) %>%
ggplot(aes(r)) + geom_histogram(binwidth = 0.05, col = "grey")
data.frame(r) %>%
ggplot(aes(r)) + geom_density(fill = "grey", col = "grey")
data.frame(r) %>%
ggplot(aes(r)) + geom_histogram(binwidth = 0.05, col = "grey")
data.frame(r) %>%
ggplot(aes(r)) + geom_density(fill = "black", col = "wihte")
data.frame(r) %>%
ggplot(aes(r)) + geom_density(fill = "black", col = "white")
data.frame(r) %>%
ggplot(aes(r)) + geom_density(fill = "darkgrey", col = "white")
data.frame(r) %>%
ggplot(aes(r)) + geom_density(fill = "grey", col = "white")
data.frame(r) %>%
ggplot(aes(r)) + geom_density(fill = "darkgrey")
data.frame(r) %>%
ggplot(aes(r)) + geom_histogram(binwidth = 0.05, col = "grey")
data.frame(r) %>%
ggplot(aes(r)) + geom_histogram(binwidth = 0.05)
data.frame(r) %>%
ggplot(aes(r)) + geom_density(fill = "darkgrey", col = "black")
data.frame(r) %>%
ggplot(aes(r)) + geom_histogram(binwidth = 0.05, fill = "darkgrey", col = "black")
source('~/Analytics/Projects/ds_linear_regression/correlation.R', echo=TRUE)
set.seed(0, sample.kind = TRUE)
?set.seed
set.seed(1, sample.kind = "Rounding")
set.seed(0, sample.kind = "Rounding")
source('~/Analytics/Projects/ds_linear_regression/correlation.R', echo=TRUE)
source('~/Analytics/Projects/ds_linear_regression/correlation.R', echo=TRUE)
source('~/Analytics/Projects/ds_linear_regression/correlation.R', echo=TRUE)
mean(r)
set.seed(1, sample.kind = "Rounding")
r <- replicate(10000, {
sample_n(galton_heights, 25, replace = TRUE) %>%
summarise(r = cor(father, son)) %>%
.$r
})
mean(r)
source('~/Analytics/Projects/ds_linear_regression/correlation.R', echo=TRUE)
sd(r)
set.seed(1)
r <- replicate(10000, {
sample_n(galton_heights, 25, replace = TRUE) %>%
summarise(r = cor(father, son)) %>%
.$r
})
mean(r)
sd(r)
set.seed(1)
r <- replicate(10000, {
sample_n(galton_heights, 40, replace = TRUE) %>%
summarise(r = cor(father, son)) %>%
.$r
})
sd(r)
mean(r)
set.seed(1)
r <- replicate(10000, {
sample_n(galton_heights, 90, replace = TRUE) %>%
summarise(r = cor(father, son)) %>%
.$r
})
mean(r)
sd(r)
set.seed(1)
r <- replicate(10000, {
sample_n(galton_heights, 150, replace = TRUE) %>%
summarise(r = cor(father, son)) %>%
.$r
})
sd(r)
mean(r)
source('~/Analytics/Projects/ds_linear_regression/correlation.R', echo=TRUE)
source('~/Analytics/Projects/ds_linear_regression/correlation.R', echo=TRUE)
galton_heights <- GaltonFamilies %>%
filter(childNum == 1 & gender == "male") %>%
select(father, childHeight) %>%
rename(son = childHeight)
source('~/Analytics/Projects/ds_linear_regression/stratification_variance.R', echo=TRUE)
View(galton_heights)
View(galton_heights)
conditional_avg <- galton_heights %>% filter(round(father) == 72) %>%
summarise(avg_son = mean(son)) %>%
.$avg_son
conditional_avg <- galton_heights %>% filter(round(father) == 72) %>%
summarise(avg_son = mean(son)) %>%
.$avg_son
conditional_avg
galton_heights %>% mutate(father_strata = factor(round(father))) %>%
ggplot(aes(father_strata, son)) +
geom_boxplot() +
geom_point()
galton_heights %>% mutate(father = round(father)) %>%
group_by(father) %>%
summarise(son_conditional_avg = mean(son)) %>%
ggplot(aes(father, son_conditional_avg)) +
geom_point()
galton_heights %>% mutate(father = round(father)) %>%
group_by(father) %>%
summarise(son_conditional_avg = mean(son)) %>%
ggplot(aes(father, son_conditional_avg)) +
geom_point() + geom_abline()
galton_heights %>% mutate(father = round(father)) %>%
group_by(father) %>%
summarise(son_conditional_avg = mean(son)) %>%
ggplot(aes(father, son_conditional_avg)) +
geom_point()
r1 <- galton_heights %>% summarise(r = cor(father, son)) %>% .$r
galton_heights %>%
mutate(father = round(father)) %>%
group_by(father) %>%
summarise(son = mean(son)) %>%
mutate(z_father = scale(father), z_son = scale(son)) %>%
ggplot(aes(z_father, z_son)) +
geom_point() +
geom_abline(intercept = 0, slope = r1)
mu_x <- mean(galton_heights$father)
mu_y <- mean(galton_heights$son)
s_x <- sd(galton_heights$father)
s_y <- sd(galton_heights$son)
r2 <- cor(galton_heights$father, galton_heights$son)
m <- r2*mu_y/mu_x
b <- mu_y - m^mu_x
b <- mu_y - m * mu_x
galton_heights %>%
ggplot(aes(father, son)) +
geom_point(alpha = 0.5) +
geom_abline(intercept = b, slope = m)
galton_heights %>%
ggplot(aes(scale(father), scale(son))) +
geom_point(alpha = 0.5) +
geom_abline(intercept = 0, slope = r2)
